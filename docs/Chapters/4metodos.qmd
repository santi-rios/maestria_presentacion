# Material y M√©todos {#sec-metodologia}


```{r setupmetodos}
#| label: setup

library(tidyverse)

# Specify the file paths
file_path_1 <- "../data/raw/animales_base_datos.csv"
file_path_2 <- "./data/raw/animales_base_datos.csv"

# TODO tratar de hacer con here::here("./data/...")


# Try reading the file from the first location
animales <- tryCatch(
  read.csv(file_path_1),
  error = function(e) {
    # If an error occurs, read the file from the second location
    read.csv(file_path_2)
  }
)

```

```{r baseDatosAnimales}
#| label: descriptivaNuRatones

# n total
animales_n <- n_distinct(animales$ID) # ver unique y distinct

# n por sexo
animales_sexo <- animales %>% 
    distinct(ID, sexo) %>% 
    count(sexo) 

animales_macho <- animales_sexo %>% 
  filter(sexo == "Macho") %>% 
  pull(n)

animales_hembra <- animales_sexo %>%
    filter(sexo == "Hembra") %>% 
    pull(n)

# n por grupo
# animales_tratamientos <- animales %>% 
#     distinct(ID, tratamiento) %>% 
#     count(tratamiento) 


# n grupos
animales_fluoxetina_CUMS <- animales %>%
  mutate(Estres = case_when(
        tratamiento %in% c("CUMS_Fluox", "CUMS_ctrl", "CUMS_Salina", "Fluoxetina_CUMS") ~ "CUMS",
        tratamiento %in% c("Fluoxetina", "Salina-Control") ~ "Control"
      ),
        Tratamiento.Farm = case_when(
          tratamiento %in% c("Fluoxetina", "CUMS_Fluox", "Fluoxetina_CUMS") ~ "Fluoxetina",
          tratamiento %in% c("CUMS_ctrl", "CUMS_Salina", "Salina-Control", "CUMS") ~ "Salina"
      ) 
      ) %>%
  filter(Estres == "CUMS") %>% 
  filter(Tratamiento.Farm == "Fluoxetina") %>% 
  distinct(ID, Tratamiento.Farm) %>% 
  count(Tratamiento.Farm) %>%
  pull(n)

animales_salina_CUMS <- animales %>%
  mutate(Estres = case_when(
        tratamiento %in% c("CUMS_Fluox", "CUMS_ctrl", "CUMS_Salina", "Fluoxetina_CUMS") ~ "CUMS",
        tratamiento %in% c("Fluoxetina", "Salina-Control") ~ "Control"
      ),
        Tratamiento.Farm = case_when(
          tratamiento %in% c("Fluoxetina", "CUMS_Fluox", "Fluoxetina_CUMS") ~ "Fluoxetina",
          tratamiento %in% c("CUMS_ctrl", "CUMS_Salina", "Salina-Control", "CUMS") ~ "Salina"
      ) 
      ) %>%
  filter(Estres == "CUMS") %>% 
  filter(Tratamiento.Farm == "Salina") %>% 
  distinct(ID, Tratamiento.Farm) %>% 
  count(Tratamiento.Farm) %>%
  pull(n)

animales_fluoxetina_noCUMS <- animales %>%
  mutate(Estres = case_when(
        tratamiento %in% c("CUMS_Fluox", "CUMS_ctrl", "CUMS_Salina", "Fluoxetina_CUMS") ~ "CUMS",
        tratamiento %in% c("Fluoxetina", "Salina-Control") ~ "Control"
      ),
        Tratamiento.Farm = case_when(
          tratamiento %in% c("Fluoxetina", "CUMS_Fluox", "Fluoxetina_CUMS") ~ "Fluoxetina",
          tratamiento %in% c("CUMS_ctrl", "CUMS_Salina", "Salina-Control", "CUMS") ~ "Salina"
      ) 
      ) %>%
  filter(Estres == "Control") %>% 
  filter(Tratamiento.Farm == "Fluoxetina") %>% 
  distinct(ID, Tratamiento.Farm) %>% 
  count(Tratamiento.Farm) %>%
  pull(n)

animales_salina_noCUMS <- animales %>%
  mutate(Estres = case_when(
        tratamiento %in% c("CUMS_Fluox", "CUMS_ctrl", "CUMS_Salina", "Fluoxetina_CUMS") ~ "CUMS",
        tratamiento %in% c("Fluoxetina", "Salina-Control") ~ "Control"
      ),
        Tratamiento.Farm = case_when(
          tratamiento %in% c("Fluoxetina", "CUMS_Fluox", "Fluoxetina_CUMS") ~ "Fluoxetina",
          tratamiento %in% c("CUMS_ctrl", "CUMS_Salina", "Salina-Control", "CUMS") ~ "Salina"
      ) 
      ) %>%
  filter(Estres == "Control") %>% 
  filter(Tratamiento.Farm == "Salina") %>% 
  distinct(ID, Tratamiento.Farm) %>% 
  count(Tratamiento.Farm) %>%
  pull(n)


# TODO: case_when para sacar grupos de estr√©s y luego tambi√©n contar por cada subrugpo

```

Se utilizaron `r animales_n - 1 -4` ratones de ambos sexos de la cruza *F1* C57BL/6 x BALB/c, de 8 semanas de edad al inicio del experimento. De estos animales, `r animales_macho -2` eran machos y `r animales_hembra + 3 - 2` eran hembras.

Los ratones se alojaron en el bioterio de la Facultad de Ciencias en cajas de acr√≠lico (`20cm * 30cm * 15cm`) en condiciones de temperatura controlada (`20¬∞C - 25¬∞C`), humedad relativa (`50 ¬± 10%`) con un ciclo de luz-oscuridad de 12 horas. Se les proporcion√≥ agua y alimento ([5001 LabDiet para roedores](https://www.labdiet.com/getmedia/edc7a620-0240-4a7a-98fa-b3d69833f9ea/5001.pdf?ext=.pdf)) *ad libitum*. Todos los animales se proporcionaron por el bioterio de la Facultad de Ciencias de la UNAM con el c√≥digo de oficio de la Comisi√≥n de √âtica Acad√©mica y Responsabilidad Cient√≠fica (CEARC) con Folio: `PI_25_05_2023_Canabal`.

De acuerdo a los [protocolos de bienestar para el cuidado de roedores](https://nc3rs.org.uk/3rs-resources/housing-and-husbandry-mouse) [@prescott2017], se [evit√≥ el manejo de los ratones por la cola](https://nc3rs.org.uk/3rs-resource-library/mouse-handling) por ser un est√≠mulo aversivo, estresante y ansiog√©nico [@henderson2020; @gouveia2017; @gouveia2019]; se proporcion√≥ refugio, cart√≥n y papel triturado para construcci√≥n de nido [@andre2018]; se mantuvieron de 3 a 5 ratones del mismo sexo por caja [@demuyser2016] y se cambi√≥ de cama (aserr√≠n comercial para roedores y ocote) 2 veces por semana [@hedrich2004].




## Dise√±o experimental

Se emple√≥ un dise√±o experimental aleatorizado con dos grupos principales: grupo control (sin protocolo \ac{cums}, n= `r animales_fluoxetina_noCUMS + animales_salina_noCUMS - 4`) y grupo con protocolo \ac{cums} (n= `r animales_fluoxetina_CUMS + animales_salina_CUMS`). Cada uno de estos grupos se subdividi√≥ en dos subgrupos, uno tratado con fluoxetina (15 mg/kg/d√≠a, n= `r animales_fluoxetina_CUMS + animales_fluoxetina_noCUMS - 2`) y otro con soluci√≥n salina (veh√≠culo, n= `r animales_salina_CUMS + animales_salina_noCUMS - 2`). En resumen, los grupos experimentales fueron los siguientes:

- **No-Estr√©s**
  - \textcolor{orange}{Salina} (n= `r animales_salina_noCUMS - 2`)
  - \textcolor{blue}{Fluoxetina} (n= `r animales_fluoxetina_noCUMS- 2`)
- \textcolor{red}{\textbf{CUMS}}
  - \textcolor{orange}{Salina} (n= `r animales_salina_CUMS`)
  - \textcolor{blue}{Fluoxetina} (n= `r animales_fluoxetina_CUMS`)

### Procedimiento

![L√≠nea del tiempo del procedimiento expimerntal a lo largo de 33 d√≠as.](../Figures/diseno_experimental.png){fig-align="center"}

***Manipulaci√≥n y habituaci√≥n al cuarto de conducta***: Para reducir el estr√©s asociado con la manipulaci√≥n de los ratones a un entorno nuevo, se implement√≥ un protocolo de habituaci√≥n dos semanas antes del inicio del experimento. Los ratones fueron manipulados cinco minutos diariamente en el cuarto de conducta donde se encuentra el \ac{mwm}. Este manejo consisti√≥ en sujetar a los ratones y permitirles explorar libremente las manos del experimentador.


***Protocolo de Pre-entrenamiento en el \ac{mwm}***: Al termino de la fase de habituaci√≥n, se realiz√≥ una prueba de aprendizaje sin pistas espaciales en el \ac{mwm} [@vorhees2006]. En este procedimiento, se colocan cortinas negras alrededor del laberinto para eliminar las se√±ales distales del cuarto con el fin de interferir con la capacidad del animal para navegar el laberinto y encontrar la plataforma, que en esta fase se encuentra visible. Se utiliza una plataforma de acr√≠lico con una "bandera" de pl√°stico que se alza aproximadamente 7 cm por encima del agua. Esta se√±al permite al animal visualizar la ubicaci√≥n de la plataforma y navegar hacia ella utilizando solamente su [memoria procedural](AppendixB.qmd#term-id-60). La localizaci√≥n de la plataforma se mantiene constante en el centro del \ac{mwm} durante los 4 ensayos que cada rat√≥n intenta durante m√°ximo 60 segundos. \todo{decir cu√°nto tiempo entre cada ensayo} Entre cada ensayo se daba un descanso de 30 segundos. El fin de este procedimiento es doble: reducir el estr√©s inicial del \ac{mwm} y asegurar que los animales no presenten deficiencias motoras y/o visuales que le impidan llegar a la plataforma.


:::: {layout="[50, -2, 48]"}

::: {#first-column}

![Medidas del laberinto acu√°tico de Morris utilizado. ](../Figures/WM_medidas.png){#fig-wmmedidas}

:::

::: {#second-column}

El laberinto de fibra de vidrio tiene un di√°metro total de 120 cm. El di√°metro de la plataforma escondida (*annulus* blanco) es de de 10 cm y se mantiene 0.3 cm bajo el agua oscurecida con pintura t√©mpera blanca. Alrededor de esta plataforma, se defini√≥ una 'zona' con un di√°metro de 20 cm. El laberinto se divide en cuatro cuadrantes virtuales: noreste, noroeste, sureste y suroeste. Por √∫ltimo, se muestran las pistas espaciales colocadas a 65 cm de la superficie del laberinto acu√°tico en cada uno de los puntos cardinales.

:::

::::

***Aprendizaje espacial en el \ac{mwm} (MWM)***: Todos los grupos fueron entrenados en el laberinto con agua opcada a $25¬± 2 ‚ÑÉ$ durante cuatro d√≠as. Cada d√≠a se utilizaron 4 ubicaciones (norte, sur, este y oeste) de inicio semi-aleatorias con una duraci√≥n m√°xima de 60 segundos por intento. Entre cada intento, los animales descansaban 30 segundos. Introducir a los animales desde posiciones distintas promueve la formaci√≥n de estrategias espaciales ([aloc√©ntricas](AppendixB.qmd#term-id-97)) [@othman2022], las cuales son modulados por el hipocampo [@dupret2008].

***Retenci√≥n de la memoria espacial en el MWM (Prueba-1)***:  El aprendizaje espacial es evaluado 24 horas despu√©s del √∫ltimo d√≠a del entrenamiento. En esta prueba, el rat√≥n nada durante 60 segundos en el mismo laberinto, pero ahora sin la plataforma oculta. La adquisici√≥n de la memoria se eval√∫a con un porcentaje mayor de ocupaci√≥n en el cuadrante (25% del √°rea de la piscina) y la zona virtual (11% del √°rea de la piscina) (@fig-wmmedidas). Estos porcentajes de ocupaci√≥n se utilizaron como *criterios de inclusi√≥n en el experimento*.

![Protocolo del Laberinto Acu√°tico de Morris para Evaluar los Efectos del Estr√©s cr√≥nico en ratones. A) Configuraci√≥n del laberinto con pistas visuales, una plataforma escondida, y sistemas de grabaci√≥n para evaluar la navegaci√≥n espacial de los ratones. B) Representaci√≥n del entrenamiento desde el primer d√≠a hasta el √∫ltimo, seguido por una prueba de memoria sin plataforma para evaluar la retenci√≥n de la memoria espacial inducida por el estr√©s.](../Figures/wm_overview_2.png){#fig-wm width="55%" fig-scap="Configuraci√≥n y Protocolo del Laberinto de Morris"}

***Inducci√≥n del Estr√©s Cr√≥nico y conductas de tipo depresivas***: Los ratones del grupo de estr√©s cr√≥nico fueron sometidos a un protocolo de \ac{cums} durante 21 d√≠as (ver calendario completo en @sec-cumCalendario). Este protocolo incluy√≥ una variedad de estresores (@fig-cummin) basados en los protocolos de @monteiro2015 y @antoniuk2019 para generar estados de tipo depresivo-ansiosos, as√≠ como alteraciones en la din√°mica hipocampal. 

![Protocolo de \ac{cums} en Ratones para Inducir d√©ficits cognitivos. Esta serie de im√°genes ilustra los estresores que se utilizaron: 1) Privaci√≥n de agua por hasta 8 horas; 2) Privaci√≥n de comida por hasta 8 horas; 3) Cambios en el ciclo de luz-oscuridad; 4) Cama mojada (200 ml en 100 g de aserr√≠n por hasta 19 horas); 5) Inclinaci√≥n de la caja a 45 ¬∫ por hasta 24 horas; 6) Levantamiento por cola m√°ximo por cinco minutos; 7) Aislamiento social en cajas individuales.](../Figures/cums.png){#fig-cummin width="55%" fig-scap="Protocolo de Estr√©s Cr√≥nico Moderado Impredecible en Ratones"}

***Tratamiento con Fluoxetina o Salina***: A la par del inicio del protocolo de \ac{cums}, los subgrupos correspondientes comenzaron a recibir una inyecci√≥n subcut√°nea (s.c.) de fluoxetina (`15 mg/kg/d√≠a`) o soluci√≥n salina (`0.85% NaCl`) con una jeringa de insulina (`31 G X 6 mm`). A pesar de que esta v√≠a de administraci√≥n es poco dolorosa y aversiva para los roedores [@hedrich2004], se altern√≥ cada d√≠a (@fig-inyeccionessubcut) entre la regi√≥n escapular (izquierda, derecha) y debajo de la nuca para reducir el estr√©s de la inyecci√≥n. Esta v√≠a de administraci√≥n s.c. asegura el mantenimiento sostenido del f√°rmaco al tener un ritmo de absorci√≥n lento, pero sostenido [@turner2011].

:::: {layout="[45, -5, 45]"}

::: {#first-column}

![Esquema de tratamiento subcut√°neo con fluoxetina o soluci√≥n salina en los ratones.](../Figures/inyecciones.png){#fig-inyeccionessubcut width=55%}

:::

::: {#second-column}

La figura ilustra el protocolo de administraci√≥n subcut√°neo (s.c.) con el objetivo de minimizar el estr√©s asociado al procedimiento de inyecci√≥n diario. Para esto, se alternaba cada d√≠a el sitio de la inyecci√≥n: *Regi√≥n Escapular* Izquierda y Derecha y la regi√≥n justo debajo de la *nuca* en la parte superior de la espalda del rat√≥n.

:::

::::

***Evaluaci√≥n de la memoria espacial remota en el \ac{mwm} (Prueba-2)***: Una semana posterior al t√©rmino del \ac{cums}, se evalu√≥ la memoria remota mediante la evocaci√≥n [@sara2000] de la memoria espacial. De manera similar a la prueba 1 (retenci√≥n), se evalu√≥ el porcentaje de ocupaci√≥n en el cuadrante y la zona virtual  (@fig-wmmedidas).

***Evaluaci√≥n de la Flexibilidad Cognitiva por medio de entrenamientos y prueba reversa (Prueba-3) en el MWM:***: Un d√≠a despu√©s de la prueba de retenci√≥n, se inici√≥ el protocolo de aprendizaje reversa en el MWM. Los paradigmas de aprendizaje reversa son una forma de analizar la flexibilidad cognitiva [@uddin2021; @vorhees2006]. De manera similar a la fase de aprendizaje espacial inicial, los ratones fueron entrenados por dos d√≠as desde las 4 posiciones para encontrar la plataforma escondida, pero ahora con la plataforma en una nueva localizaci√≥n en el cuadrante opuesto al original. La capacidad de reaprender la localizaci√≥n de la nueva plataforma se evalu√≥ 24 horas despu√©s del √∫ltimo entrenamiento reversa en una prueba de 60 segundos donde se remueve la plataforma escondida y se analiza el tiempo en el cuadrante y zona [@epp2016].

***Perfusi√≥n y Sacrificio de los sujetos***: 90 minutos posterior a la prueba reversa del MWM, se anestesiaron a los animales con pentobarbital s√≥dico a una dosis letal por v√≠a intraperitoneal (210 mg/kg i.p., diluido 1:3 en soluci√≥n salina est√©ril al 0.85%). Tras asegurarnos que el animal no presentaba reflejos locomotores, se expon√≠a la cavidad tor√°cica para realizar la perfusi√≥n con 50 ml de soluci√≥n de sacarosa al 10%, seguida de 50 ml de paraformaldeh√≠do al 3.7%. Los cerebros extra√≠dos se almacenaron el mismo perfusato en refrigeraci√≥n hasta su procesamiento histol√≥gico.


## An√°lisis de datos

Las coordenadas de los animales registradas fueron obtenidas con el programa de automatizaci√≥n de videos AnyMaze (versi√≥n 4.99). A partir de estas coordenadas se calcularon las distinas m√©tricas de comportamiento en el \ac{mwm} mediante el paquete `Rtrack` [@overall2020]. Los datos fueron analizados y graficados utilizando el lenguaje R ([Versi√≥n 4.4.3](https://cran.r-project.org/bin/windows/base/)) por medio del software VScode ([Versi√≥n 1.97](https://code.visualstudio.com/download)).

Para comparar las conductas en el \ac{mwm}, se utiliz√≥ un an√°lisis de varianza de [medidas repetidas](AppendixB.qmd#term-id-80) (ANOVA) considerando dos factores con interacci√≥n en el modelo entre sujetos (*between-subjects*): el factor del **tratamiento** farmacol√≥gico (\textcolor{olive}{Salina}, \textcolor{blue}{Fluoxetina}) y el factor de **estr√©s** (Sin-estr√©s, \textcolor{red}{CUMS}). Adicionalmente, se tom√≥ en cuenta factores dentro de sujetos (*within-subjects* o "medidas repetidas"): para el caso del an√°lisis de la variable *latencia*, el factor *within* fue el tiempo; para el caso de las variables de *tiempo en cuadrante* y *tiempo en zona*, el factor *within* fue la categor√≠a de *preferencia* por el cuadrante/zona (blanco *vs* opuestos). Debido a la incorporaci√≥n de factores entre y dentro sujetos, se considera formalmente un *ANOVA de dise√±o mixto*. La variable *distancia media al blanco* fue analizada sin un factor *within* en un ANOVA de dos v√≠as.

Se utilizaron ANOVAs con suma de cuadrados tipo III (dise√±o no balanceado) y correcci√≥n de Greenhouse‚ÄìGeisser en los factores *within* cuando se violaba el supuesto de esfericidad (`Mauchly < p.05`). El tama√±o del efecto se calculo con el coeficiente $\eta^2$ [@olejnik2003], el cu√°l es recomendado para calcular el tama√±o de efecto en dise√±os de medidas repetidas [@bakeman2005]. Para el correcto c√°lculo de $\eta^2$, se especificaron en cada caso las variables observadas (i.e. no manipuladas). En caso de detectar una interacci√≥n significativa, se realizaron comparaciones *post hoc* con el m√©todo de **Holm-Bonferroni** para comparaciones m√∫ltiples con el fin de determinar cu√°les grupos difer√≠an entre s√≠. Se consider√≥ un nivel de significancia de `p < 0.05` para todas las pruebas.

Con el fin de evaluar las tres pruebas en conjunto para analizar a detalle la adquisici√≥n, evocaci√≥n y reaprendizaje de la memoria, se model√≥ el t√©rmino de interacci√≥n `prueba x tratamiento x estr√©s` (modelar las medias y t√©rminos de errores a trav√©s del tiempo) [@deboer2015; @garofalo2022]. Es decir, determinamos la memoria de referencia y su evoluci√≥n a trav√©s del tiempo en los distintos tratamientos [@tucker2018]. Para este an√°lisis, utilizamos dos m√©tricas altamente sensibles al aprendizaje espacial, la distancia media al *annulus* y la entrop√≠a [@maei2009; @maei2009a] y una m√©trica cl√°sica, el tiempo de ocupaci√≥n en la zona blanco. Para estos an√°lisis se modelaron [regresiones lineales](AppendixB.qmd#term-id-82) con [efectos mixtos](AppendixB.qmd#term-id-71) (estimado usando [REML](AppendixB.qmd#term-id-83)) considerando los factores de `tratamiento` y `estr√©s` y la variable num√©rica correspondiente al n√∫mero de la prueba (`1=prueba 1; 2=prueba 2 y 3 = reversa`). Se incluy√≥ el identificador √∫nico del rat√≥n como [variable aleatoria](AppendixB.qmd#term-id-72). Los modelos fueron realizados con el paquete de R `lme4` [@bates2015] y se determin√≥ la significancia de las interacciones utilizando la prueba de [raz√≥n de verosimilitud](AppendixB.qmd#term-id-73) (*likelihood ratio*) para comparar el modelo sin el t√©rmino de interacci√≥n ($H_0$) con el modelo completo ($H_a$). Se realizaron las comparaciones *post hoc* con el paquete `emmeans` ([medias marginales](AppendixB.qmd#term-id-74)) utilizando el m√©todo de Tukey para comparaciones m√∫ltiples. Se consider√≥ un nivel de significancia de `p < 0.05` para todas las pruebas.

Para calcular las estrategias de b√∫squeda se utiliz√≥ el paquete `Rtrack` [@overall2020]. Se agruparon las estrategias en 3 categor√≠as:
- **Estrategias [egoc√©ntricas](AppendixB.qmd#term-id-98)**: tigmotaxis, circulaci√≥n, b√∫squeda aleatoria, encadenamiento y exploraci√≥n (@fig-estrategiasrandom y @fig-estrategiachaining).
- **Estrategias [aloc√©ntricas](AppendixB.qmd#term-id-97)**: b√∫squeda dirigida, b√∫squeda enfocada y nado directo (@fig-estrategiasalocentricas).
- **Perseverancia**. Se considera aparte debido a la importancia de este fen√≥meno en la evaluaci√≥n de la flexibilidad cognitiva. 

Se analizaron los patrones de movimiento y las √°reas de mayor permanencia de ratones en tres pruebas (retenci√≥n, memoria remota y reversa) mediante la generaci√≥n de mapas de densidad. Para ello, se utilizaron las coordenadas $x$ y $y$ obtenidas a 10 cuadros por segundo durante las pruebas del \ac{mwm}, las cuales se procesaron usando el \ac{kde} con un kernel gaussiano. Este m√©todo asigna mayor peso a los puntos cercanos y menor a los m√°s distantes, permitiendo estimar la densidad de probabilidad de encontrar al rat√≥n en un espacio continuo [@chen2017c].

Para entender mejor la interacci√≥n entre variables categ√≥ricas (prueba, tipo de estrategia [cuenta] y tratamiento), ajustamos una regresi√≥n de [Poisson](AppendixB.qmd#term-id-77) (modelado tipo *inflaci√≥n-cero*) con efectos mixtos (utilizando [m√°xima verosimilitud](AppendixB.qmd#term-id-78)). La variable de respuesta es el n√∫mero de tipo de estrategias y las variables predictoras son el tiempo, tratamiento y estr√©s. Se incluyeron a los ratones como efectos mixtos para tomar en cuenta la dependencia de los datos en el tiempo (medidas repetidas). Para visualizar e interpretar los efectos estimados en este modelo, utilizamos las [medias marginales](AppendixB.qmd#term-id-74) para representan los valores esperados de la variable dependiente (en este caso, el n√∫mero de estrategias observadas) para cada combinaci√≥n de niveles de las variables categ√≥ricas, ajustados por el efecto de otras covariables incluidas en el modelo.

## Entrop√≠a

### Derivaci√≥n de la f√≥rmula de entrop√≠a

A partir de la descripci√≥n de la derivaci√≥n de entrop√≠a por @maei2009 y @dajun2003, se deriv√≥ este c√°lculo (utilizando el lenguaje de programaci√≥n R) con los siguientes pasos:

El c√°lculo de las distancias se obtuvo de las coordenadas del animal, las diferencias del animal al punto de referencia (*annulus* blanco), el cuadrado de la distancia Euclidiana, la distancia Euclidiana y el promedia de la distancia ($œÉ_d$). Con estos par√°metros, se calcul√≥ la distancia del animal a la plataforma en cada tiempo utilizando la distancia Euclidiana tomando en cuenta las coordenadas del animal ($x_a, y_a$) y de la plataforma planco ($x_b, y_b$).

\todo{Agregar el primer t√©rmino al cuadrado en el texto:}

$$
d = \sqrt{(x_a - x_b)^2 + (y_a - y_b)^2}
$$ 

Las medias ponderadas y la matriz de varianza-covarianza se contruy√≥ a partir de la matriz de covarianza que resulta de las medias ponderadas. La matriz de covarianza de valores [Eigen](AppendixB.qmd#term-id-89) se calcula para obtener la varianza $œÉ_a^2$ y $ùúé_b^2$. Con estos par√°metros se calcul√≥ la varianza de los vectores de las distancias del animal respecto a la plataforma. La matriz de covarianza se representa como:

$$
Œ£=\begin{pmatrix}
Var(x) & Cov(x,y)\\
Cov(x,y) & Var(y)
\end{pmatrix}
$$

Donde `Var(x)` representa la varianza de las coordenadas X, `Var(y)` representa la varianza de las coordenadas Y, y `Cov(x,y)` representa la covarianza entre las coordenadas de X y Y. Esta matriz de covarianza resume c√≥mo las coordenadas var√≠an entre ellas. Si las coordenadas X y Y est√°n altamente correlacionadas, la covarianza ser√° alta, indicando una relaci√≥n linear alta.

Los ejes principales o valores Eigen son las direcciones en las que los datos var√≠an m√°s. Estos ejes se encontraron realizando una descomposici√≥n en valores propios de la matriz de covarianza. Los valores propios y los vectores propios obtenidos de esta descomposici√≥n tienen las siguientes intepretaciones:

- *Valores Propios*: Representan la magnitud de la varianza a lo largo de los ejes principales.

- *Vectores Propios*: Indican la direcci√≥n de estos ejes principales.

Estos ejes pueden considerarse como los ejes mayor y menor de una elipse de error que mejor se ajusta a los datos. Los logaritmos de las varianzas se suman utilizando en el c√°lculo de la entrop√≠a para cuantificar la dispersi√≥n o el desorden de los datos en el plano, reflejando el producto de las varianzas a lo largo de los ejes principales

El c√°lculo final de entrop√≠a se obtiene sumando los logaritmos de las medias cuadradas de la distancia y el producto de los valores Eigen. En resumen, calculamos $H_{error}$ basados en la f√≥rmula $H_{error} = log(varianza_{distancia})$, calculamos la varianza de la trayectoria $var(X_a) + var(Y_a)$, calculamos la entrop√≠a de la trayectoria, realizamos la operaci√≥n $H_{trayectoria} = log(var_{trayectoria})$ y finalmente calculamos la entrop√≠a total como $H_{total} = H_{error} + H_{trayectoria}$. En la @fig-plotentropia, se ilustra este proceso del c√°lculo de entrop√≠a.

Para validar la m√©trica de entrop√≠a desarrollada en este estudio, se compararon los resultados obtenidos con nuestro m√©todo frente a los c√°lculos de entrop√≠a realizados con otras m√©tricas cl√°sicas del \ac{mwm}, obteniendo un coeficiente de correlaci√≥n alto (r) entre ambas (@tbl-entropiacor). Sin embargo, la validaci√≥n adicional de la m√©trica se realiz√≥ comparando nuestros resultados con los obtenidos por el c√°lculo de entrop√≠a original propuesto por @maei2009, el cual fue replicado en un estudio posterior por @cooke2020. Este √∫ltimo proporciona los datos crudos y rotulados de su experimento en un repositorio de Github, lo que permiti√≥ realizar un rean√°lisis de su experimento utilizando nuestro c√≥digo de c√°lculo de entrop√≠a. Se analizaron un total de 141 pruebas del \ac{mwm} utilizando tanto el m√©todo de Cooke (basado en MATLAB) como el m√©todo propuesto en este estudio (basado en R). Las diferencias entre las entrop√≠as calculadas por ambos m√©todos fueron evaluadas mediante una prueba *t de Student* pareada.

Para evaluar el acuerdo y la equivalencia entre las entrop√≠as calculadas por ambos m√©todos, se utiliz√≥ el an√°lisis de **Bland-Altman** [@martinbland1986]. Este m√©todo eval√∫a la concordancia entre dos mediciones continuas, ya que no solo considera la correlaci√≥n entre ellas, sino que tambi√©n permite detectar posibles sesgos sistem√°ticos y visualizar los l√≠mites de acuerdo entre las dos metodolog√≠as. El an√°lisis de Bland-Altman se realiz√≥ graficando la diferencia entre las entrop√≠as calculadas por ambos m√©todos frente al promedio de las dos medidas. Los l√≠mites de acuerdo se calculan como la diferencia media ¬± 1.96 veces la desviaci√≥n est√°ndar de las diferencias (con un intervalo de confianza del `95%`).


### Desarrollo de aplicaci√≥n interactiva para calcular entrop√≠a

Se desarroll√≥ una aplicaci√≥n web interactiva para facilitar el c√°lculo de la entrop√≠a a partir de las coordenadas espaciales de los animales en el \ac{mwm}. La aplicaci√≥n est√° disponible p√∫blicamente en [https://santi-rios.github.io/maestria_app_water_maze/](https://santi-rios.github.io/maestria_app_water_maze/). Esta herramienta permite la carga de archivos en formato CSV que contienen las coordenadas de los animales durante las pruebas, calcula la entrop√≠a a partir de dichas coordenadas y genera un gr√°fico que ilustra el c√°lculo.

La aplicaci√≥n fue desarrollada utilizando el paquete [Shiny](https://shiny.rstudio.com/) de [R](https://www.r-project.org/), un marco para el desarrollo de aplicaciones web interactivas, que permite la manipulaci√≥n de datos y la generaci√≥n de gr√°ficos de manera din√°mica. La aplicaci√≥n cuenta con una interfaz simple e intuitiva que permite al usuario cargar un archivo CSV con las coordenadas de las trayectorias de los animales. Adem√°s, el usuario puede ajustar manualmente los par√°metros necesarios para el c√°lculo de la entrop√≠a, como las coordenadas de la plataforma objetivo (en el formato *x*, *y*), las coordenadas centrales del aparato, y el radio del √°rea de an√°lisis (annulus). 

Una vez que se han ingresado los datos y par√°metros, el usuario puede hacer clic en el bot√≥n "Calcular H" para realizar el c√°lculo de entrop√≠a. Los resultados se presentan en una **Tabla de resultados** que muestra la entrop√≠a calculada y un **gr√°fico ilustrativo** que muestra las trayectorias del animal alrededor del annulus, la ubicaci√≥n de la plataforma, y la relaci√≥n espacial entre los puntos de la trayectoria y la plataforma objetivo. 

El c√≥digo completo de la aplicaci√≥n est√° disponible en el repositorio asociado y est√° desarrollado utilizando los paquetes de R `shiny` para la interfaz web, `dplyr` y `janitor` para la manipulaci√≥n de datos, y `car` para el c√°lculo de la funci√≥n el√≠ptica que forma parte del proceso de c√°lculo de la entrop√≠a. La @fig-entropiaApp muestra la interfaz de la aplicaci√≥n, la cual permite una f√°cil interacci√≥n con los datos para el an√°lisis de entrop√≠a en el MWM.


## Descripci√≥n general de los sujetos experimentales

En el @sec-descgeneral se puede encontrar m√°s informaci√≥n general sobre los sujetos experimentales, como un resumen descriptivo de las variables analizadas, su distribucu√≥n (histogramas) y el peso de los ratones a lo largo del experimento.